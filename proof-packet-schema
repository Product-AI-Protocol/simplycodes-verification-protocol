{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SimplyCodes Proof Packet",
  "description": "A structured evidence bundle documenting the full adjudication chain behind a coupon verification verdict. See: Anatomy of a Verdict, Part III.",
  "type": "object",
  "required": ["code", "merchant", "verdict", "confidence", "evidence"],
  "properties": {
    "code": {
      "type": "string",
      "description": "The coupon code string that was adjudicated."
    },
    "merchant": {
      "type": "string",
      "description": "The merchant domain against which the code was verified."
    },
    "verdict": {
      "type": "string",
      "enum": ["VERIFIED", "UNVERIFIED", "INVALIDATED", "CONFIDENT_NO"],
      "description": "The adjudication outcome. VERIFIED: code exists and functions. UNVERIFIED: insufficient signal. INVALIDATED: confirmed dead by consensus. CONFIDENT_NO: verified absence of working codes for this merchant."
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Health Score at time of verdict issuance. Derived from event stream, not stored as static value."
    },
    "evidence": {
      "type": "object",
      "required": ["automated_test", "human_consensus", "fleet_signal", "health"],
      "properties": {
        "automated_test": {
          "type": "object",
          "description": "Layer 1: Automated Code Testing (ACT) results.",
          "properties": {
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp of the test execution."
            },
            "result": {
              "type": "string",
              "enum": ["FUNCTIONAL", "EXPIRED", "CONDITION", "BLOCKED", "AUTHENTICATION_REQUIRED", "UI_CHANGED"],
              "description": "Test outcome per the Failure Taxonomy. FUNCTIONAL: code accepted by merchant system. EXPIRED: merchant confirmed code is dead. CONDITION: code exists but has scope constraints. BLOCKED: bot detection prevented test. AUTHENTICATION_REQUIRED: login needed. UI_CHANGED: promo field not found."
            },
            "tier": {
              "type": "string",
              "enum": ["PLATFORM_ADAPTER", "HEURISTIC", "AI_NAVIGATION"],
              "description": "The tiered intelligence method used for this test. PLATFORM_ADAPTER: deterministic adapter for standardized checkout. HEURISTIC: pattern matching for custom platforms. AI_NAVIGATION: LLM-powered navigation for truly custom flows."
            },
            "session_id": {
              "type": "string",
              "description": "Unique session identifier linking this test to its full diagnostic metadata and evidence capture."
            }
          }
        },
        "human_consensus": {
          "type": "object",
          "description": "Layer 2: Human Verification Network results. Blind voting consensus from reputation-weighted verifiers.",
          "properties": {
            "independent_verifications": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of independent human verifications submitted."
            },
            "positive": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of positive verifications (code worked)."
            },
            "weighted_confidence": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Trust-weighted consensus score accounting for each verifier's historical accuracy, consistency, and tenure."
            }
          }
        },
        "fleet_signal": {
          "type": "object",
          "description": "Layer 3: Fleet Signal from browser extension users during actual checkouts. Ground truth, not simulation.",
          "properties": {
            "recent_successes": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of successful real-world code applications in the observation window."
            },
            "recent_failures": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of failed real-world code applications in the observation window."
            },
            "trend": {
              "type": "string",
              "enum": ["STABLE", "IMPROVING", "DEGRADING"],
              "description": "Directional trend of fleet signal over the observation window."
            }
          }
        },
        "health": {
          "type": "object",
          "description": "Health Score metadata. The score is a computation over the full event history, not a number in a database column.",
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Current Health Score. Derived from convergence of freshness, outcome, verifier trust, automated test confidence, merchant pattern, decay clock, and fleet signal."
            },
            "decay_rate": {
              "type": "string",
              "enum": ["SLOW", "MODERATE", "RAPID"],
              "description": "Variable decay rate based on code type. SLOW: evergreen codes (months). MODERATE: regular codes (weeks). RAPID: flash codes (hours to days)."
            },
            "last_verified": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp of the most recent verification event from any layer."
            },
            "staleness": {
              "type": "string",
              "enum": ["FRESH", "AGING", "STALE"],
              "description": "Human-readable freshness classification derived from decay_rate and time since last_verified."
            }
          }
        }
      }
    }
  }
}
